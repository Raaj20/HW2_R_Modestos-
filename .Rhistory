knitr::opts_chunk$set(echo = TRUE, setwd("Common_files"))
library(readr)
library(data.table)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(data.table)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(data.table)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
setwd("Common_files")  # Set working directory once here
library(readr)
library(data.table)
library(tidyverse)
fang_et_al_genotypes <- read_delim("fang_et_al_genotypes.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
fang_et_al_genotypes <- read_delim("Common_files/fang_et_al_genotypes.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
setwd("Common_files")
snp_position <- read_delim("snp_position.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
fang_et_al_genotypes <- read_delim("Common_files/fang_et_al_genotypes.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
file_size_mb <- file.size("Common_files/fang_et_al_genotypes.txt") / (1024 * 1024)
print(paste("File size:", round(file_size_mb, 2), "MB"))
snp_position <- read_delim("Common_files/snp_position.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
file_size_mb <- file.size("Common_files/snp_position.txt") / 1024
print(paste("File size:", round(file_size_mb, 2), "KB"))
lines <- readLines("Common_files/transposed_genotypes.txt")
lines <- lines[-c(1, 2)]
writeLines(lines, "Common_files/transposed_oneheader.txt")
lines <- readLines("Common_files/transposed_oneheader.txt")
lines <- gsub("Group", "SNP_ID", lines)
writeLines(lines, "Common_files/transposed_editedheader.txt")
snp_position <- read.delim("Common_files/snp_position.txt", header = TRUE, sep = "\t")
transposed_editedheader <- read.delim("Common_files/transposed_editedheader.txt", header = TRUE, sep = "\t")
joined_data <- inner_join(snp_position, transposed_editedheader, by = colnames(snp_position)[1])
write.table(joined_data, "Common_files/joined_unedited.txt", sep = "\t", row.names = FALSE, quote = FALSE)
data <- fread("Common_files/joined_unedited.txt", sep = "\t", header = TRUE)
data <- data[, -2, with = FALSE]
fwrite(data, "Common_files/joined_final.txt", sep = "\t", quote = FALSE)
header <- fread("Common_files/joined_final.txt", nrows = 1, header = FALSE, sep = "\t")
header_dt <- data.table(Index = seq_along(header), Column = as.character(unlist(header)))
zmmil_dt <- header_dt[grepl("Common_files/ZMMIL", Column)]
fwrite(zmmil_dt, "Common_files/ZMMIL.txt", sep = "\t", quote = FALSE, col.names = FALSE)
header <- fread("Common_files/joined_final.txt", nrows = 1, header = FALSE, sep = "\t")
header_dt <- data.table(Index = seq_along(header), Column = as.character(unlist(header)))
zmmil_dt <- header_dt[grepl("Common_files/ZMMIL", Column)]
fwrite(zmmil_dt, "Common_files/ZMMIL.txt", sep = "\t", quote = FALSE, col.names = FALSE)
header <- fread("Common_files/joined_final.txt", nrows = 1, header = FALSE, sep = "\t")
header_dt <- data.table(Index = seq_along(header), Column = as.character(unlist(header)))
zmmlr_dt <- header_dt[grepl("Common_files/ZMMLR", Column)]
fwrite(zmmlr_dt, "Common_files/ZMMLR.txt", sep = "\t", quote = FALSE, col.names = FALSE)
header <- fread("Common_files/joined_final.txt", nrows = 1, header = FALSE, sep = "\t")
header_dt <- data.table(Index = seq_along(header), Column = as.character(unlist(header)))
zmmmr_dt <- header_dt[grepl("Common_files/ZMMMR", Column)]
fwrite(zmmmr_dt, "Common_files/ZMMMR.txt", sep = "\t", quote = FALSE, col.names = FALSE)
data <- fread("Common_files/joined_final.txt", sep = "\t", header = TRUE)
selected_columns <- c(1, 2, 3, 1224:2479, 2480:2506, 2507:2796)
maize_data <- data[, ..selected_columns]
fwrite(maize_data, "Common_files/maize_data.txt", sep = "\t", quote = FALSE)
file_path <- "Common_files/maize_data.txt"
data <- fread(file_path, sep = "\t", header = TRUE)
col_name <- grep("^Chromosome$", names(data), value = TRUE)
data[, (col_name) := suppressWarnings(as.numeric(get(col_name)))]
data <- data[!is.na(get(col_name))]
sorted_data <- data[order(get(col_name)), ]
output_path <- "Common_files/sorted_maize.txt"
fwrite(sorted_data, output_path, sep = "\t", quote = FALSE)
file_path <- "Common_files/sorted_maize.txt"
data <- fread(file_path, sep = "\t", header = TRUE)
# Loop through chromosome values (1 to 10) and create separate files
for (i in 1:10) {
# Filter rows where Chromosome == i
subset_data <- data[get(col_name) == i]
if (nrow(subset_data) > 0) {
output_file <- sprintf("maize_chr%02d.txt", i)
fwrite(subset_data, output_file, sep = "\t", quote = FALSE)
}
}
file_path <- "Common_files/sorted_maize.txt"
data <- fread(file_path, sep = "\t", header = TRUE)
# Loop through chromosome values (1 to 10) and create separate files
for (i in 1:10) {
# Filter rows where Chromosome == i
subset_data <- data[get(col_name) == i]
if (nrow(subset_data) > 0) {
output_file <- file.path("Common_files", sprintf("maize_chr%02d.txt", i))
fwrite(subset_data, output_file, sep = "\t", quote = FALSE)
}
}
getwd()
header <- fread("Common_files/joined_final.txt", nrows = 1, header = FALSE, sep = "\t")
header_dt <- data.table(Index = seq_along(header), Column = as.character(unlist(header)))
zmpba_dt <- header_dt[grepl("Common_files/ZMPBA", Column)]
fwrite(zmpba_dt, "Common_files/ZMPBA.txt", sep = "\t", quote = FALSE, col.names = FALSE)
header <- fread("Common_files/joined_final.txt", nrows = 1, header = FALSE, sep = "\t")
header_dt <- data.table(Index = seq_along(header), Column = as.character(unlist(header)))
zmpil_dt <- header_dt[grepl("Common_files/ZMPIL", Column)]
fwrite(zmpil_dt, "Common_files/ZMPIL.txt", sep = "\t", quote = FALSE, col.names = FALSE)
header <- fread("Common_files/joined_final.txt", nrows = 1, header = FALSE, sep = "\t")
header_dt <- data.table(Index = seq_along(header), Column = as.character(unlist(header)))
zmpja_dt <- header_dt[grepl("Common_files/ZMPJA", Column)]
fwrite(zmpja_dt, "Common_files/ZMPJA.txt", sep = "\t", quote = FALSE, col.names = FALSE)
data <- fread("Common_files/joined_final.txt", sep = "\t", header = TRUE)
selected_columns <- c(1, 2, 3, 88:987, 988:1021, 1177:1217)
teosinte_data <- data[, ..selected_columns]
fwrite(teosinte_data, "Common_files/teosinte_data.txt", sep = "\t", quote = FALSE)
file_path <- "Common_files/teosinte_data.txt"
data <- fread(file_path, sep = "\t", header = TRUE)
col_name <- grep("^Chromosome$", names(data), value = TRUE)
data[, (col_name) := suppressWarnings(as.numeric(get(col_name)))]
data <- data[!is.na(get(col_name))]
sorted_data <- data[order(get(col_name)), ]
output_path <- "Common_files/sorted_teosinte.txt"
fwrite(sorted_data, output_path, sep = "\t", quote = FALSE)
file_path <- "Common_files/sorted_teosinte.txt"
data <- fread(file_path, sep = "\t", header = TRUE)
# Loop through chromosome values (1 to 10) and create separate files
for (i in 1:10) {
# Filter rows where Chromosome == i
subset_data <- data[get(col_name) == i]
if (nrow(subset_data) > 0) {
output_file <- sprintf("teosinte_chr%02d.txt", i)
fwrite(subset_data, output_file, sep = "\t", quote = FALSE)
}
}
file_path <- "Common_files/sorted_teosinte.txt"
data <- fread(file_path, sep = "\t", header = TRUE)
# Loop through chromosome values (1 to 10) and create separate files
for (i in 1:10) {
# Filter rows where Chromosome == i
subset_data <- data[get(col_name) == i]
if (nrow(subset_data) > 0) {
output_file <- file.path("Common_files", sprintf("teosinte_chr%02d.txt", i))
fwrite(subset_data, output_file, sep = "\t", quote = FALSE)
}
}
